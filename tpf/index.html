
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>TPFMachine - PSFMachine</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation-for-tpfmachine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PSFMachine" class="md-header__button md-logo" aria-label="PSFMachine" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m5.8 21 1.6-7L2 9.2l7.2-.6L12 2l2.8 6.6 7.2.6-3.2 2.8H18c-3.1 0-5.6 2.3-6 5.3L5.8 21M17 14v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PSFMachine
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TPFMachine
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/SSDataLab/psfmachine/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PSFMachine" class="md-nav__button md-logo" aria-label="PSFMachine" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m5.8 21 1.6-7L2 9.2l7.2-.6L12 2l2.8 6.6 7.2.6-3.2 2.8H18c-3.1 0-5.6 2.3-6 5.3L5.8 21M17 14v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2z"/></svg>

    </a>
    PSFMachine
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/SSDataLab/psfmachine/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../machine/" class="md-nav__link">
        Machine
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          TPFMachine
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        TPFMachine
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine" class="md-nav__link">
    psfmachine.tpf.TPFMachine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.fit_lightcurves" class="md-nav__link">
    fit_lightcurves()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.from_TPFs" class="md-nav__link">
    from_TPFs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.lcs_in_tpf" class="md-nav__link">
    lcs_in_tpf()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.load_shape_model" class="md-nav__link">
    load_shape_model()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.plot_tpf" class="md-nav__link">
    plot_tpf()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.save_shape_model" class="md-nav__link">
    save_shape_model()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ffi/" class="md-nav__link">
        FFIMachine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aperture/" class="md-nav__link">
        Aperture Photometry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../superstamp/" class="md-nav__link">
        SSMachine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Tutorial_10_TPFs/" class="md-nav__link">
        Intro to PSFMachine Tutorial 1.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Tutorial_11_TPFs/" class="md-nav__link">
        TPFMachine Tutorial 1.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Tutorial_20_FFI/" class="md-nav__link">
        FFIMachine Tutorial 2.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Tutorial_30_k2ss/" class="md-nav__link">
        SSMachine Tutorial 3.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Tutorial_31_k2ss/" class="md-nav__link">
        SSMachine Tutorial 3.1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine" class="md-nav__link">
    psfmachine.tpf.TPFMachine
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.fit_lightcurves" class="md-nav__link">
    fit_lightcurves()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.from_TPFs" class="md-nav__link">
    from_TPFs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.lcs_in_tpf" class="md-nav__link">
    lcs_in_tpf()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.load_shape_model" class="md-nav__link">
    load_shape_model()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.plot_tpf" class="md-nav__link">
    plot_tpf()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psfmachine.tpf.TPFMachine.save_shape_model" class="md-nav__link">
    save_shape_model()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/SSDataLab/psfmachine/edit/master/docs/tpf.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="documentation-for-tpfmachine">Documentation for <code>TPFMachine</code></h1>


  <div class="doc doc-object doc-class">

<a id="psfmachine.tpf.TPFMachine"></a>
    <div class="doc doc-contents first">

      <p>Subclass of <code>Machine</code> that specifically works with TPFs</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h2 id="psfmachine.tpf.TPFMachine.fit_lightcurves" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit_lightcurves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fit_va</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iter_negative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">load_shape_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shape_model_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Fit the sources inside the TPFs passed to <code>TPFMachine</code>.</p>
<p>This function creates the <code>lcs</code> attribuite that contains a collection of light
curves in the form of <code>lightkurve.LightCurveCollection</code>. Each entry in the
collection is a <code>lightkurve.KeplerLightCurve</code> object with the different type
of photometry (SAP, PSF, and PSF velocity-aberration corrected). Also each
<code>lightkurve.KeplerLightCurve</code> object includes its asociated metadata.
The photometry can also be accessed independently from the following attribuites
that <code>fit_lightcurves</code> create:
    * <code>ws</code> and <code>werrs</code> have the uncorrected PSF flux and flux errors.
    * <code>ws_va</code> and <code>werrs_va</code> have the PSF flux and flux errors corrected by
    velocity aberration.
    * <code>sap_flux</code> and <code>sap_flux_err</code> have the flux and flux errors computed
    using aperture mask.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>plot</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to show some diagnostic plots. These can be helpful
for a user to see if the PRF and time dependent models are being calculated
correctly.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>fit_va</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to fit Velocity Aberration (which implicitly will try to fit
other kinds of time variability). This will try to fit the "long term"
trends in the dataset. If True, this will take slightly longer to fit.
If you are interested in short term phenomena, like transits, you may
find you do not need this to be set to True. If you have the time, it
is recommended to run it.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>iter_negative</code></td>
        <td><code>bool</code></td>
        <td><p>When fitting light curves, it isn't possible to force the flux to be
positive.
As such, when we find there are light curves that deviate into negative flux
values, we can clip these targets out of the analysis and rerun the model.
If iter_negative is True, PSFmachine will run up to 3 times, clipping out
any negative targets each round.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>load_shape_model</code></td>
        <td><code>bool</code></td>
        <td><p>Load PRF shape model from disk or not. Default models were computed from
FFI of the same channel and quarter.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>shape_model_file</code></td>
        <td><code>string</code></td>
        <td><p>Path to PRF model file to be passed to <code>load_shape_model(input)</code>. If None,
then precomputed models will be download from Zenodo repo.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sap</code></td>
        <td><code>boolean</code></td>
        <td><p>Compute or not Simple Aperture Photometry. See
<code>Machine.compute_aperture_photometry()</code> for details.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="psfmachine.tpf.TPFMachine.from_TPFs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_TPFs</span><span class="p">(</span><span class="n">tpfs</span><span class="p">,</span> <span class="n">magnitude_limit</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">dr</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">time_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_focus_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">query_ra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query_dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query_rad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>

    <div class="doc doc-contents ">

      <p>Convert TPF input into Machine object:</p>
<ul>
<li>Parse TPFs to extract time, flux, clux erros, and bookkeeping of
    the TPF-pixel correspondance<ul>
<li>Convert pixel-based coordinates (row, column) into WCS (ra, dec) for
all pixels</li>
<li>Clean pixels with no values, bad cadences, and remove duplicated pixels
due to overlapping TPFs</li>
<li>Query Gaia DR2 data base to find all sources present in the TPF images</li>
<li>Clean unresolve sources (within 6`` = 1.5 pixels) and sources off silicon
with a 1 pixel tolerance (distance from source gaia pocition and TPF edge)</li>
</ul>
</li>
</ul>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tpfs</code></td>
        <td><code>lightkurve TargetPixelFileCollection</code></td>
        <td><p>Collection of Target Pixel files</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>magnitude_limit</code></td>
        <td><code>float</code></td>
        <td><p>Limiting magnitude to query Gaia catalog.</p></td>
        <td><code>18</code></td>
      </tr>
      <tr>
        <td><code>dr</code></td>
        <td><code>int</code></td>
        <td><p>Gaia data release to be use, default is 2, options are DR2 and EDR3</p></td>
        <td><code>2</code></td>
      </tr>
      <tr>
        <td><code>time_mask</code></td>
        <td><code>boolean array</code></td>
        <td><p>Mask to be applied to discard cadences if needed.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>apply_focus_mask</code></td>
        <td><code>boolean</code></td>
        <td><p>Mask or not cadances near observation gaps to remove focus change.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>query_ra</code></td>
        <td><code>numpy.array</code></td>
        <td><p>Array of RA to query Gaia catalog. Default is <code>None</code> and will use the
coordinate centers of each TPF.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>query_dec</code></td>
        <td><code>numpy.array</code></td>
        <td><p>Array of Dec to query Gaia catalog. Default is <code>None</code> and will use the
coordinate centers of each TPF.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>query_rad</code></td>
        <td><code>numpy.array</code></td>
        <td><p>Array of radius to query Gaia catalog. Default is <code>None</code> and will use
the coordinate centers of each TPF.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>None</code></td>
        <td><p>Keyword arguments to be passed to <code>TPFMachine</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Machine object</code></td>
      <td><p>A Machine class object built from TPFs.</p></td>
    </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="psfmachine.tpf.TPFMachine.lcs_in_tpf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lcs_in_tpf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tpf_number</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Returns the light curves from a given TPF as a lightkurve.LightCurveCollection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tpf_number</code></td>
        <td><code>int</code></td>
        <td><p>Index of the TPF</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="psfmachine.tpf.TPFMachine.load_shape_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_shape_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Loads a PRF shape model from a FITs file.</p>
<p>Not implemented: By default this function will load PRF shapes computed from
FFI data (Kepler, K2, or TESS).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input</code></td>
        <td><code>string</code></td>
        <td><p>Name of the file containing the shape parameters and weights. The file
has to be FITS format.
If None, then previously computed shape model from Kepler's FFI will be
download from https://zenodo.org/record/5504503/ and used as default.
The file download from Zenodo happens only the first time that shape models
of a given mission (e.g. Kepler, K2) are asked. Then, shape models for all
channels and quarters will be locally available for future use.
The file is stored in <code>psfmachine/src/psfmachine/data/</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>plot</code></td>
        <td><code>boolean</code></td>
        <td><p>Plot or not the mean model.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="psfmachine.tpf.TPFMachine.plot_tpf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_tpf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tdx</span><span class="p">,</span> <span class="n">sap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Make a diagnostic plot of a given TPF in the stack</p>
<p>If you passed a stack of TPFs, this function will show an image of that
TPF, and all the light curves inside it, alongside a diagnostic of which
source the light curve belongs to.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tdx</code></td>
        <td><code>int</code></td>
        <td><p>Index of the TPF to plot</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sap</code></td>
        <td><code>boolean</code></td>
        <td><p>Overplot the pixel mask used for aperture photometry.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="psfmachine.tpf.TPFMachine.save_shape_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_shape_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Saves the weights of a PRF fit to disk as a FITS file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>output</code></td>
        <td><code>str, None</code></td>
        <td><p>Output file name. If None, one will be generated.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../machine/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Machine" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Machine
            </div>
          </div>
        </a>
      
      
        
        <a href="../ffi/" class="md-footer__link md-footer__link--next" aria-label="Next: FFIMachine" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              FFIMachine
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>